\documentclass[12pt]{ociamthesis}

\usepackage{amssymb}
\usepackage{titlesec}
\usepackage{amsmath}
\DeclareMathOperator{\arcsec}{arcsec}
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subfig}
\usepackage{xcolor}
\usepackage[section]{placeins}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{stmaryrd}
\usepackage{siunitx}
\usepackage{rotating}
\usepackage[utf8]{inputenc}
\usepackage[round]{natbib}

\usepackage{geometry}
 \geometry{
 a4paper,
 left=40mm,
 right=30mm,
 top=30mm,
 bottom=30mm
 }

\definecolor{theblue}{HTML}{0000CD}

% disable this package for printed version
\usepackage[colorlinks=true, linktocpage=true, allcolors=theblue]{hyperref}

\titleformat{\chapter}[display]
  {\bfseries\Large}
  {\filright\MakeUppercase{\chaptertitlename} \Large\thechapter}
  {1ex}
  {}
  [\vspace{1ex} \hrule \vspace{1pt} \hrule]

\newcommand{\adv}{    {\it Adv. Space Res.}} 
\newcommand{\araa}{    {\it Annual Review of Astron and Astrophys.}} 
\newcommand{\annG}{   {\it Ann. Geophys.}} 
\newcommand{\aap}{    {\it Astron. Astrophys.}}
\newcommand{\aaps}{   {\it Astron. Astrophys. Suppl.}}
\newcommand{\aapr}{   {\it Astron. Astrophys. Rev.}}
\newcommand{\ag}{     {\it Ann. Geophys.}}
\newcommand{\aj}{     {\it Astron. J.}} 
\newcommand{\apj}{    {\it Astrophys. J.}}
\newcommand{\apjl}{   {\it Astrophys. J. Lett.}}
\newcommand{\apss}{   {\it Astrophys. Space Sci.}} 
\newcommand{\bain}{   {\it Bulletin of the Astronomical Institutes of the Netherlands.}} 
\newcommand{\cjaa}{   {\it Chin. J. Astron. Astrophys.}} 
\newcommand{\gafd}{   {\it Geophys. Astrophys. Fluid Dyn.}}
\newcommand{\grl}{    {\it Geophys. Res. Lett.}}
\newcommand{\ijga}{   {\it Int. J. Geomagn. Aeron.}}
\newcommand{\jastp}{  {\it J. Atmos. Solar-Terr. Phys.}} 
\newcommand{\jgr}{    {\it J. Geophys. Res.}}
\newcommand{\mnras}{  {\it Mon. Not. Roy. Astron. Soc.}}
\newcommand{\na}{     {\it New Astronomy}}
\newcommand{\nat}{    {\it Nature}}
\newcommand{\pasp}{   {\it Pub. Astron. Soc. Pac.}}
\newcommand{\pasj}{   {\it Pub. Astron. Soc. Japan}}
\newcommand{\pre}{    {\it Phys. Rev. E}}
\newcommand{\solphys}{{\it Solar Phys.}}
\newcommand{\sovast}{ {\it Soviet  Astron.}} 
\newcommand{\ssr}{    {\it Space Sci. Rev.}}
\newcommand{\caa}{    {\it Chinese Astron. Astrohpys.}} 
\newcommand{\apjs}{   {\it Astrophys. J. Suppl.}}
\newcommand{\zap}{   {\it Zeitschrift fuer Astrophysik}}

\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\bn}{\boldsymbol{\nabla}}
\newcommand{\rgas}{\mathcal{R}}
\newcommand{\eref}[1]{Eq. \eqref{#1}}
\newcommand{\fref}[1]{Fig. \eqref{#1}}
\newcommand\encircle[1]{%
  \tikz[baseline=(X.base)] 
    \node (X) [draw, shape=circle, inner sep=0] {\strut #1};}
\newcommand{\Alfven}{Alfv\'{e}n } 
\newcommand{\Alfvenic}{Alfv\'{e}nic }
\newcommand{\size}{0.75}
\newcommand\measureISpecification{4ex}% not defined in mwe
\newcommand{\ctab}[1]{\raisebox{\dimexpr \measureISpecification/2 -.748ex}{#1}}% vertically centers numbers
\newcommand{\mfig}[4]{
  \begin{figure}
  \begin{center}
  \includegraphics[width=#1\linewidth]{#2}
  \caption{#3}
  \label{#4}
  \end{center}
  \end{figure}}
\newcommand{\np}{\\ \\}

\begin{document}

\baselineskip=18pt

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% START COPYING HERE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------------------------------------------------------------------------------
\chapter{Numerical Recipe}
\label{chap:Numerical_Recipe}
%-------------------------------
\section{MPI-AMRVAC}
All the simulatioon carried out in this thesis uses the open source software Message Passing Interface Adaptive Mesh Refinement Versatile Advection Code (MPI-AMRVAC). This sofware is developed in Fortran 90 parallezied with Message Passing Interface(MPI) \citep{Keppens_2012} and focused on using shock capturing schemes to retain near-conservation of the systeme of euqaitons. Essiantly, the code solves any systems of hyperbolic partial differential in conservative form as show: 
\begin{equation}\label{AMRVAC_stlye}
\frac{\partial \boldsymbol{U}}{\partial t} + \nabla \cdot \boldsymbol{F}(\boldsymbol{U}) = \boldsymbol{S}_{phys} (\boldsymbol{U}, \partial_{i} \boldsymbol{U}, \partial_i \partial_j \boldsymbol{U},\boldsymbol{x},t) ,
\end{equation}
where $U$ is the set of conserved variables, $F(U)$ the corresponding fluxes and $S_{phys}$ are the source terms. The source terms are used to add extra physics e.g. gravity, diffusion, viscosity, etc. If we are working with the ideal MHD equation with no gravity then $S_{phys} = $0 and we would have $U=(\rho, \boldsymbol{m}, e, \boldsymbol{B})$. \np
%
MPI-AMRVAc is constructed to solve the conservation equations. However, it is possible to define your input of initial conditions in primitive form $U = (\rho, \boldsymbol{v}, p, \boldsymbol{B})$. If defined this manner the conservative quantities are calculated from the primitive input and then the systems of equations are solved spatially and temporally. The creators of this code took much care to make sure the conversion from primate to conservative (or vise versa) does not cause a lack of precision. \np      
%solves the MHD equations in the following form:
%\begin{equation}
%\frac{\partial \rho}{\partial t} + \nabla \cdot (\boldsymbol{v} \rho) = 0 ,
%\end{equation}
%\begin{equation}
%\frac{\partial \rho \boldsymbol{v}}{\partial t} + \nabla \cdot (\boldsymbol{v} \rho \boldsymbol{v} - \boldsymbol{BB})+ \nabla p_{tot} = 0 ,
%\end{equation}
%\begin{equation}
%\frac{\partial e}{\partial t} + \nabla \cdot (\boldsymbol{v}e - \boldsymbol{BB} \cdot + \boldsymbol{v} p_tot) = \nabla \cdot (\boldsymbol{B} \times \eta \boldsymbol{j}) ,
%\end{equation}
%\begin{equation}
%\frac{\partial \boldsymbol{B}}{\partial t}+ \nabla \cdot (\boldsymbol{Bv}-\boldsymbol{Bv}) = -\nabla \times (\eta \boldsymbol{j}) ,
%\end{equation}
%\begin{equation}
%p=(\gamma-1)(e- \frac{\rho \boldsymbol{v}^2-\boldsymbol{B}^2}{2}) .
%\end{equation}
The main focus of this software is on conservation laws in particular with shock dominated problems. MPI-AMRVAC has been constructed so it is a single versatile software with options and switches for various problems rather than developing a different method or version for each problem separately. You have a selection of physics modules that come with he codes such as HD, MHD, SRHD, SRMHD and you can create your own physics model as long as the equation are of the form given by Eq. \eqref{AMRVAC_stlye}. There is a selection a numerical solver available for both temporal and spatial discretization. Once the solver and physics modules have been selected the user can write a user file. The contents of this file gives the initial inputs or acts on the evolving quantities during the simulation e.g. define a boundary condition that has continuous inflow. The advantage of this approach is that it allows for a reduction of overall time for software development. \np
%
The advantage of using AMR is it allows us to increase resolution on areas of interest (i.e where smaller scale dynamics are occurring) without having to increase the resolution of the whole domain which would be computationally expensive. The reason why we are using MPI-AMRVAC for this project is to deal with the different length scales occurring in the simulation.
%---------------------------------
%NeeD TO MERGE
%--------------
MPI-AMRVAC is an MPI-parallelized Adaptive Mesh Refinement code. AMRVAC solves a systems of hyperbolic partial differential equations by a number of different numerical schemes. In principle the ARMVAC handles anything of the generic form: 
\begin{equation}
\frac{\partial \boldsymbol{U}}{\partial t} + \nabla \cdot \boldsymbol{F}(\boldsymbol{U}) = \boldsymbol{S}_{phys} (\boldsymbol{U}, \partial_{i} \boldsymbol{U}, \partial_i \partial_j \boldsymbol{U},\boldsymbol{x},t) .
\end{equation}
%solves the MHD equations in the following form:
%\begin{equation}
%\frac{\partial \rho}{\partial t} + \nabla \cdot (\boldsymbol{v} \rho) = 0 ,
%\end{equation}
%\begin{equation}
%\frac{\partial \rho \boldsymbol{v}}{\partial t} + \nabla \cdot (\boldsymbol{v} \rho \boldsymbol{v} - \boldsymbol{BB})+ \nabla p_{tot} = 0 ,
%\end{equation}
%\begin{equation}
%\frac{\partial e}{\partial t} + \nabla \cdot (\boldsymbol{v}e - \boldsymbol{BB} \cdot + \boldsymbol{v} p_tot) = \nabla \cdot (\boldsymbol{B} \times \eta \boldsymbol{j}) ,
%\end{equation}
%\begin{equation}
%\frac{\partial \boldsymbol{B}}{\partial t}+ \nabla \cdot (\boldsymbol{Bv}-\boldsymbol{Bv}) = -\nabla \times (\eta \boldsymbol{j}) ,
%\end{equation}
%\begin{equation}
%p=(\gamma-1)(e- \frac{\rho \boldsymbol{v}^2-\boldsymbol{B}^2}{2}) .
%\end{equation}
The main focus of this software is on conservation laws in particular with shock dominated problems. AMRVAC has been constructed so it is a single versatile software with options and switches for various problems (e.g. HD, MHD, adiabatic, relativistic, choices in numerical solvers, ect) rather than developing a different method or version for each problem separately. The advantage of this approach is that it allows for a reduction of overall time for software development. One of the main reasons for using AMRVAC for carrying out numerical simulations of these jets is to deal with differences in the order of magnitude in length scales involved in this research. This has been my main task over the last 9 months becoming acquainted with AMRVAC software. As part of this I have become comfortable with using ICEBERG and ParaView (open-source software that is used visualise the output).
\subsection{MHD Equations} 
We will model Solar jets by taking a fluid approach using the magnetohydrodynamic (MHD) equations. The MHD equations are a combination of the Navier$â€“$Stokes equations of fluid dynamics and  Maxwell's equations of electromagnetism. It describes the motion of magnetic fluids in the presence of the electromagnetic fields, which is well suited to describe the dynamics of a plasma. A plasma is a completely ionised gas, consisting of freely moving positively charged ions, which behaves collectively in the presence of a magnetic field and is the forth state of matter. From a human's perspective the typical states of matter encountered in our day to day life on Earth mainly appears in three phases of solid, liquid and gas. We may observe plasmas on Earth for example lightning, TVs and neon lamps. However, if we consider matter on a universal scale, then we see that $90 \%$ of baryonic matter in the universe is plasma. Hence, we conclude that plasma is the normal state of baryonic matter in the universe \citep{goedbloed2004principles}. An interesting property of the MHD equations is they are scale independent. This means the MHD equations provides a basis for the description of the macroscopic dynamics of $90 \%$ of baryonic matter in the Universe and also are applicable to laboratory plasma such as in tokamaks ($20$ m) to astrophysical plasmas such as accretion disc of a active galactic nucleus ($10^{21}$  m) \citep{goedbloed2004principles}. The MHD theory is a fluid approach which is valid if the length scales of the system are larger than the Debye shielding length. The Debye shielding length defines the typical length scale in which the ions and electrons neutralise one another and thus the particles feel no force from the electric field. The fluid motion describes the collective motion of particles. This collective interaction involving motion, currents and magnetic fields describes the general behaviour of the MHD fields. The MHD equations are given by the following:      
\begin{equation}\label{eq86}
\frac{\partial \rho}{\partial t} = - \nabla \cdot (\rho \boldsymbol{v}),
\end{equation}
\begin{equation}\label{eq87}
\rho \frac{d \boldsymbol{v}}{dt} = - \nabla p + \frac{1}{\mu_0} (\nabla \times \boldsymbol{B}) \times \boldsymbol{B} + \rho \boldsymbol{g},
\end{equation}
\begin{equation}\label{eq88}
\frac{dp}{dt} = - \gamma p \nabla \cdot \boldsymbol{v},
\end{equation}
\begin{equation}\label{eq89}
\frac{\partial \boldsymbol{B}}{\partial t} = \nabla \times (\boldsymbol{v} \times \boldsymbol{B}) - \frac{1}{\mu_0} \nabla \times (\eta \nabla \times \boldsymbol{B}),
\end{equation}
\begin{equation}\label{eq90}
\nabla \cdot \boldsymbol{B} = 0.
\end{equation}
Where Eq. (\ref{eq86}) is the mass continuity equation which states matter cannot be created or destroyed it simply changes to a different form of matter. Eq. (\ref{eq87}) is the momentum equation, it represents balance between acceleration, also the balance between the pressure gradient and the Lorentz force (force which is exerted by a magnetic field on a moving charge, $\frac{1}{\mu_0} (\nabla \times \boldsymbol{B}) \times \boldsymbol{B}$). As the Lorentz force is directed perpendicular to the magnetic field, this means that the acceleration along the magnetic field lines are caused by pressure gradient or gravity. Eq. \eqref{eq88} represents the internal energy and Eq. \eqref{eq89} is the induction equation and links the dynamics of the magnetic field through the velocity term. Eq. \eqref{eq90} is the solenoidal constraint and implies that there are no magnetic monopoles or pure sinks of the magnetic field.\\ \\ To gain intuitive understanding of oscillations in a plasma we derive analytically MHD equations. We take small perturbation with respect to the background quantities, therefore we define the following:
\begin{equation} \label{eq91}
\boldsymbol{B} = \boldsymbol{B}_0 + \boldsymbol{B}_1 (\boldsymbol{r},t) , \ \ \boldsymbol{v} = \boldsymbol{v}_1 (\boldsymbol{r}, t) , \ \ \rho = \rho_0 + \rho_1 ( \boldsymbol{r},t) , \ \ p = p_0 + p_1 ( \boldsymbol{r}, t) ,
\end{equation}
where $\boldsymbol{r} = (x,y,z)$ is the potion vector. The subscript $0$ ($1$) represents the equilibrium quantity (Eulerian perturbation). Where $v_0=0$ as we assume no background flow. Applying the perturbations shown by Eq. \eqref{eq91} to Eq. \eqref{eq86} to Eq. \eqref{eq90} obtains the linearised MHD equations: 
\begin{equation}
\frac{\partial \rho_1}{\partial t} = \nabla \cdot (\rho_0 \boldsymbol{v}_1) ,
\end{equation}
\begin{equation}
\rho_0 \frac{\partial \boldsymbol{v}_1}{\partial t}  = - \nabla p_1 + \frac{1}{\mu_0} (\nabla \times \boldsymbol{B}_0) \times \boldsymbol{B}_1 + \frac{1}{\mu_0} (\nabla \times \boldsymbol{B}_1) \times \boldsymbol{B}_0 ,
\end{equation}
\begin{equation}
\frac{\partial p_1}{\partial t} = - \boldsymbol{v}_1 \cdot \nabla p_0 - \gamma p_0 \nabla \cdot \boldsymbol{v}_1 , 
\end{equation}
\begin{equation}
\frac{\partial \boldsymbol{B}_1}{\partial t} = \nabla \times (\boldsymbol{v}_1 \times \boldsymbol{B}_0) - \nabla \times (\eta \nabla \times \boldsymbol{B}_1) ,
\end{equation}
\begin{equation}
\nabla \cdot \boldsymbol{B}_0 = \nabla \cdot \boldsymbol{B}_1 = 0 .
\end{equation}
These equations are the used to construct our models for the oscillations. 
\subsubsection{Adaptive Mesh Refinement}
Need to give full description of AMR. 
\begin{figure}
\centering
\includegraphics[width = \textwidth]{figures/amrpng.png}
\caption{A generic AMR block skeleton fom: https:$//$homes.esat.kuleuven.be$/$ $\sim$keppens/amrstructure.html}.
\label{amr_scheme}
\end{figure}   
%------------------------------------------------------------------------------
\subsection{Atmospheric Equilibrium}
\label{sec:atmos_equil}
%------------------------------------------------------------------------------
The transition region is located at $2$ Mm where the temperature smoothly connects an $8000$ K photosphere to $1.5$ MK corona as shown in \fref{atoms_profile}. The temperature of the atmosphere as a function of height is mathematically represented as,   
\begin{equation}\label{te_pro}
T_0(y>0) = T_{ch}+\frac{T_{c} - T_{ch}}{2} \left[ \tanh \left( \frac{y-y_{tr}}{w_{tr}} \right)+1 \right],
\end{equation}
where $y$ is the vertical position, $T_0(0)=T_{ch}=8\times10^3 \ \rm{K}$ ($T_{c}=1.8\times10^6 \ \rm{K}$) is the chromospheric (coronal) temperature and $y_{tr}=2$ Mm ($w_{tr}=0.02$ Mm) is the TR height (width). As there is a uniform vertical magnetic, hence $\bs{J} \times \bs{B}=0$ and magnetohydrostatic equilibrium is achieved with,
\begin{equation}
\frac{dp}{dy} = - \rho g.
\end{equation}
Temperature and pressure are related through the ideal gas law,
\begin{equation}
p = \frac{ \rho \rgas T}{M},
\end{equation} 
where $M$ is the mean atomic weight, $T$ is the temperature and $\rgas$ is the universal gas constant. Therefore, one can obtain the $\rho$ and $p$ in the following form,  
\begin{equation}\label{p_pro}
p(y) = p_0 \exp \left( - \int_0^y  \frac{1}{H(y')} dy' \right), 
\end{equation} 
\begin{equation}\label{rho_pro}
\rho(y) = \rho_0 \frac{T_0}{T(y)} \exp \left( \int_0^y \frac{1}{H(y') }dy' \right),
\end{equation}
where $\rho_0$ and $p_0$ are the initial mass density and pressure equilibrium, respectively, at the lower boundary of the computational domain, and the pressure scale heights are given by,
\begin{equation}
H(y) = \frac{\rgas T(y)}{Mg}.
\end{equation}
Using the temperature profile given by \eref{te_pro} and taking $\rho_0 = 2.34e-4\times10^{-4}\;\rm{kg}\;\rm{m^{-3}}$ we construct pressure and mass density as function of height by means of \eref{p_pro} and \eref{rho_pro}.
%------------------------------------------------------------------------------
\subsection{Grid Setup}
\label{sec:Grid_Setup}
%------------------------------------------------------------------------------
We use the open source MPI-AMRVAC software version 2.0 \cite{Xia_2017} to simulation solar jets in a simple solar atmosphere. We set the domain size to $50$ Mm $\times$ $30$ Mm with a level one resolution of $32$ $\times$ $24$ (giving a physical resolution of $\sim$ $1.56$ Mm $\times$ $1.25$ Mm). This coarse level one resolution was chosen to allow the dissipation of shocks as they travel towards the boundaries. To accurately capture the sharpness of the TR we applied 7 levels of AMR giving a spatial resolution of $\sim$ $12$ km$\times$ $10$ km. We use unidirectional grid stretching in the horizontal direction, where from the origin the grid cells change by a constant factor of $1.1$ from cell to cell. Due to the choice of discretisation scheme for the boundary conditions, we employ ghost cells of 2 grid layers encasing the physical domain in each direction, which have a physical size of $3 \ \rm{Mm}$. The numerical scheme applied for spatial discretisation is HLL (Harten-Lax-van Leer) \cite{hll_1983} and a third order \u{C}ada limiter \citep{CADA20094118} for the time discretisation. We use CFL number of $0.8$ and GLM-MHD method to maintain $\bs{\nabla} \cdot \bs{B}=0$ \citep{DEDNER2002645}. The initial magneto-hydrostatics stratification places the TR at $2$ Mm where the temperature smoothly links $8000$ K chromosphere to a $1.8$ Mm corona (see Fig. 1). For the left and right boundary we utilise a periodic boundary condition. In the  ghost cells of the lower boundary we fix $\rho$, $e$ and $\bs{B}$ to their initial values. In the ghost cells for the upper boundary the values for $\rho$, $e$ are determined by the gravitational stratification and $\bs{B}$ was extrapolated assuming zero normal gradient. For both upper and lower boundary we take an antisymmetric boundary for the velocity components.
%fffffffffffffffffffffff
\mfig{1}{figures/numerical_Setup.png}{Top left plot displays the an example of the grid at $t=0$. Top right plot shows initial temperature (red line) and density (blue dashed) stratification in the first $10$ Mm. the lower panels from left to right to an example of Gaussian distribution for $A=60$ km s$^{-1}$ and $j_w=375$ km marked by red points at $t=0$ and the driver velocity with $A=60$ km s$^{-1}$, $P=300$ s..}{atoms_profile}
%fffffffffffffffffffffffff
%------------------------------------------------------------------------------      
\subsection{Driver}
\label{subsec:driver}
%------------------------------------------------------------------------------
To drive the jet we us a momentum pulse at the base of computational domain for a specified period of time (ranging from $50-300s$). The jet is launched symmetrically by a driver in the center of the computational domain which varies both spatially and temporally. In the x-direction the jet vertical velocity is Gaussian with the FHWM of $350 \ \rm{km}$ ($j_w$) and as the jet evolves in time it will reach a switch off phase in which it will shut off with a hyperbolic tangent,
\begin{equation}
v_{j}(x) = -\frac{A}{2} \left( \tanh \left( \frac{\pi (t-t_{d})}{t_d}+ \pi \right) +1 \right) \exp \left( - \left(\frac{x-x_0}{\Delta x} \right)^2  \right),
\end{equation}    
where $v_j$ is the velocity of the jet, $A$ is the amplitude of the driver, $t$ is time, $t_{d}$ is the time for $v_j=0$ , $P$ is the period of the driver and $x_0$ is central location of the jet injection. The driver the width of the Gaussian is determined by $\Delta x$ which is the FWHM based of the jet width (see \fref{atoms_profile}),
\begin{equation}
\Delta x = \dfrac{j_w}{4 \sqrt{2 \log{2}}},
\end{equation}  
%fffffffffffffffffffff
%\begin{figure}
%\hspace{-1.5cm}
%\captionsetup[subfigure]{labelformat=empty}
%\subfloat[]{\includegraphics[width=0.6\linewidth]{figures/driver_dt_off.png}} 
%\subfloat[]{\includegraphics[width=0.6\linewidth]{figures/driver_dx.png}} 
%\caption{Example of driver velocity with $A=60$ km s$^{-1}$, $P$ and switch off time of $300$ s (LHS) and Gaussian distribution for $A=60$ km s$^{-1}$ and $j_w=375$ km marked by red points (RHS).}
%\label{fig4}
%\end{figure}
%ffffffffffffffffffffff

\section{Outline of Thesis}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%not need
%\subsubsection{Numerical Techniques}
%Solving differential equations are key part of understanding the physics occurring in nature. Often coupled systems of differential equations can not be solved analytically without making major assumption to simply the equation and thus removing important physics from the original problem. A classic example of a system of equations which isn't solvable analytically is the three body problem where using Newtonian mechanics you consider three masses interacting with one another through gravitational force. The numerical soultions to this problem allowed the revolution in modern space flights, and the launch of the two Voyager probes. By using numerical techniques on the MHD equations we gain an insight into systems which are too complex to obtain analytically.  \\ \\A differential is the gradient of a function over an infinitesimally small range. The numerical approximation takes this range and makes it finite, calculation the differential from an approximation dependent on the selected method. In the sub-sections I will summarise a selection of solvers used in the MPI-AMRVAC code that are applied in this thesis.
%\subsubsection{Finite Difference Method}
%The general expression for a derivative is the following:
%\begin{equation}
%f'(x)=\lim\limits _{h\to0}\frac{f(x+h)-f(x)}{h} , 
%\end{equation}
%the finite difference method (FDM) approximates this equation by taking the step size $h$ as finite. The general form of a finite difference equation is $f(x+b)-f(x+a)$. The two simplest forms are:
%\begin{align}
%\Delta_+ f =  f(x+h)-f(x), \\
%\Delta_- f = f(x-h)-f(x) .
%\end{align}
%These equations can be used to calculate the derivatives by using the following:
%\begin{align}
%\text{Forward Difference: }&f'(x) = \frac{f(x+h)-f(h)}{h} , \\
%\text{Backwards Difference: }&f'(x) = \frac{f(x)-f(x-h)}{h}
%\end{align}
%These equations can be derived from a Taylor expansion of $f(x\pm h)$,
%\begin{align}
%f(x-h) & = f(x)-h f'(x)+\frac{h^{2}f''(x)}{2!}-\frac{h^{3}f'''(x)}{3!}+\frac{h^{4}f^{iv}(x)}{4!}+...\label{eq:TaylorForward}\\
%f(x+h) & = f(x)+h f'(x)+\frac{h^{2}f''(x)}{2!}+\frac{h^{3}f'''(x)}{3!}+\frac{h^{4}f^{iv}(x)}{4!}+...\label{eq:TaylorBackward}
%\end{align}
%The forward (backwards) difference equations is the first-order truncation of the $f(x+h)$ ($f(x+h)$) Taylor series. From this it can be seen that the truncation error of a forward and backward difference approximation is $O(h)$, and that the accuracy is easily improved by increasing the number of terms included. \\ \\
%Another variation of FDM that reduces the error, while maintaining the first-order nature of these solutions is achieved by combining the forward and backward difference into a central difference approximation of the following form: 
%\begin{equation}
%f(x)=\frac{1}{2} \left(f(x + h) + f(x - h)\right).
%\end{equation}
%Preforming a Taylor expansion and taking first order as previous done results in the following: 
%\begin{equation}
%f'(x)=\frac{f(x+h)-f(x-h)}{2h}.\label{eq:First Order CD}
%\end{equation}
%The  error for central difference approximation $O(h^{2})$ as we have combined both the two Taylor series expansions. The accuracy of the solution is important, for it determines how well the computed solution represents the true solution. The most obvious way to increase the accuracy of the solution is to increase the number of terms included from the Taylor expansion of the forward and backward differences. For example the derivation of a fourth-order central difference scheme which can be calculated by starting from Eqs. \eqref{eq:TaylorForward}-\eqref{eq:TaylorBackward} and subtracting the second from the first, to the fourth order gives, in one dimension the following:
%\begin{equation}
%f(x+h)-f(x-h)=2 h f'(x)+\frac{2 h^{3} f'''(x)}{3!}+O(h^{4}).\label{eq:centraldifferencedx}
%\end{equation}
%The next step is to calculate the same subtraction for $2 h$ which can be written as:
%\begin{equation}
%f(x+2 h)-f(x-2 h)=4 h f'(x)+\frac{16 h^{3}f'''(x)}{3!}+O(h^{4}).\label{eq:CentralDifference2dx}
%\end{equation}
%Then subtracting \eqref{eq:CentralDifference2dx} from $8\times$(\eqref{eq:centraldifferencedx}) and rearranging for $f'(x)$ results in:
%\begin{equation}
%f'(x)=\frac{8f(x+h)-8f(x-h)-f(x+2h)+f(x-2h)}{12h}+O(h^{4}),\label{eq:4thOrderCentralDifferenceUniform}
%\end{equation}
%which is the fourth order central difference scheme in one dimension for a uniform spacing of $\pm h$.
%This scheme can be expanded into $n$ dimensions by using the basic property of differentiation $\frac{\partial^{2}u}{\partial x\partial y}=\frac{\partial}{\partial x}\left(\frac{\partial u}{\partial y}\right)=\frac{\partial}{\partial y}\left(\frac{\partial u}{\partial x}\right)$. This scheme provides good accuracy while being computationally efficient.
%\subsubsection{TVLD}
%Need to add other solvers used in AMRVAC.
%\subsection{Atmospheric Model}
%%Need to add images background for models. 
%SP2RC has a method for constructing 3D MHD equilibrium for multiple magnetic flux tubes in a stratified solar atmosphere \citep{Gent_2013p1,Gent_2014p2}. This solar atmospheric model incorporates a wide and realistic range of scales using the combined results of \cite{Vernazza_1981ApJS}  VALIIIC model for the chromosphere and \cite{McWhirter1975} for the lower corona. This model can then used in Sheffield Advance Code \citep{Griffiths2013} which splits the equation in terms of its steady state for the background, then governing equations can be reduced, solving only the evolution for the perturbations. Capturing the true dynamics of these phenomena requires realistic flux tube models and this is the aim of this project. We will study the jet origin, excitation and multiple jet excitation employing a novel 3D MHD code. We will validate results with high-resolution data (e.g. CRISP) to gain insight into the relationship between various solar transients (e.g. jets, MBPs, RBE). By using this combination of numerical simulations and observations of the penetration of jets from the chromosphere, through the transition region into the corona, we will reveal how momentum and energy are transported to the upper atmosphere.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% STOP COPYING HERE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{plainnat}
\bibliography{references}  

\end{document}
